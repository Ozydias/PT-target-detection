# YOLOv12s 训练说明

## 数据集结构

您的 PTDataset 数据集应该具有以下结构：
```
PTDataset/
├── train/              # 训练图像
│   └── *.jpg
├── val/               # 验证图像
│   └── *.jpg
├── labels/
│   ├── train/         # 训练标签（YOLO格式）
│   │   └── *.txt
│   └── val/           # 验证标签（YOLO格式）
│       └── *.txt
└── annonations/       # COCO格式标注（可选，用于转换）
    ├── instances_train.json
    └── instances_val.json
```

## 快速开始

### 1. 检查数据集

确保您的数据集已经准备好：
- 图像文件在 `PTDataset/train/` 和 `PTDataset/val/` 目录
- YOLO格式标签文件在 `PTDataset/labels/train/` 和 `PTDataset/labels/val/` 目录

如果标签文件不存在，但您有COCO格式的标注文件，训练脚本会自动转换。

### 2. 开始训练

运行训练脚本：

```bash
python train_yolov12s.py
```

### 3. 训练参数说明

主要训练参数（可在 `train_yolov12s.py` 中修改）：

- **epochs**: 训练轮数（默认100，建议100-300）
- **batch**: 批次大小（默认16，根据GPU内存调整）
  - 8GB GPU: 8-16
  - 16GB GPU: 16-32
  - 32GB GPU: 32-64
- **imgsz**: 输入图像尺寸（默认640）
- **device**: GPU设备（默认'0'，多GPU可用'0,1,2,3'）
- **scale**: 0.9（YOLOv12s推荐值）
- **mixup**: 0.05（YOLOv12s推荐值）
- **copy_paste**: 0.15（YOLOv12s推荐值）

### 4. 训练结果

训练完成后，结果会保存在：
```
runs/detect/yolov12s_pt/
├── weights/
│   ├── best.pt      # 最佳模型权重
│   └── last.pt      # 最后一个epoch的权重
├── results.png      # 训练曲线图
├── confusion_matrix.png
└── ...
```

### 5. 使用训练好的模型

```python
from ultralytics import YOLO

# 加载训练好的模型
model = YOLO('runs/detect/yolov12s_pt/weights/best.pt')

# 进行预测
results = model('path/to/image.jpg')
results[0].show()

# 或者进行验证
metrics = model.val(data='PTDataset.yaml')
```

## 注意事项

1. **GPU内存不足**：如果遇到CUDA out of memory错误，减小 `batch` 参数
2. **训练时间**：根据数据集大小和GPU性能，训练可能需要几小时到几天
3. **预训练权重**：首次运行会自动下载预训练权重（约20MB）
4. **类别数**：当前配置为1个类别（PT），如需修改，请编辑 `PTDataset.yaml`

## 命令行训练（替代方案）

您也可以使用命令行直接训练：

```bash
yolo train model=yolov12s.pt data=PTDataset.yaml epochs=100 batch=16 imgsz=640 device=0
```

## 故障排除

1. **找不到数据集**：确保 `PTDataset.yaml` 和数据集目录在同一目录下
2. **标签格式错误**：确保标签文件是YOLO格式（每行：`class_id center_x center_y width height`，归一化坐标）
3. **CUDA错误**：检查GPU驱动和PyTorch CUDA版本是否匹配


